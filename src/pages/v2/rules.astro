---
import V2Layout from '../../layouts/V2Layout.astro';
import Card from '../../components/v2/ui/Card.astro';
import Button from '../../components/v2/ui/Button.astro';
import { getEntry } from 'astro:content';
import { AlertTriangle, Book, MessageSquareText, Copy } from '@lucide/astro';

const rules = await getEntry('rules', 'main');
if (!rules) throw new Error('Rules entry "main" not found');

const { warning, minecraft, discord, serverIp } = rules.data;
const ip = serverIp || 'minecraft-gilde.de';
---

<V2Layout
  title="Minecraft Gilde – Regeln (v2)"
  canonical="https://minecraft-gilde.de/v2/rules"
  description="Regeln für Minecraft & Discord – Minecraft Gilde."
>
  <section class="v2-container pt-12 pb-6">
    <h1 class="text-3xl font-semibold tracking-tight">Regeln</h1>
    <p class="text-muted mt-2">Fair play. Wenig Bürokratie. Klare Grenzen.</p>

    <div class="v2-callout mt-6" data-variant="warning">
      <div class="flex gap-3">
        <AlertTriangle size={20} class="mt-0.5" />
        <div>
          <p class="text-sm font-semibold">Wichtiger Hinweis</p>
          <p class="text-fg/90 mt-1 text-sm">{warning}</p>
        </div>
      </div>
    </div>

    <div class="mt-6 flex flex-wrap gap-3">
      <Button variant="primary" class="gap-2" data-copy-ip>
        <Copy size={18} /> IP kopieren
      </Button>
      <Button href="/v2/erststart" variant="secondary"> Erststart </Button>
      <Button href="/stats" variant="ghost"> Statistiken </Button>
    </div>

    <p class="text-muted mt-3 text-xs">IP: <span class="text-fg/90 font-medium">{ip}</span></p>
  </section>

  <section class="v2-container pb-16">
    <div class="grid gap-4 lg:grid-cols-2">
      <Card class="p-6">
        <div class="flex items-start gap-3">
          <Book size={20} />
          <div>
            <h2 class="text-xl font-semibold tracking-tight">{minecraft.title}</h2>
            <ol class="mt-4 space-y-4">
              {
                minecraft.items.map((it) => (
                  <li class="border-border bg-surface rounded-lg border p-4">
                    <div class="text-sm font-semibold">{it.title}</div>
                    <div class="text-muted mt-2 text-sm leading-relaxed" set:html={it.html} />
                  </li>
                ))
              }
            </ol>
          </div>
        </div>
      </Card>

      <Card class="p-6">
        <div class="flex items-start gap-3">
          <MessageSquareText size={20} />
          <div>
            <h2 class="text-xl font-semibold tracking-tight">{discord.title}</h2>
            <ol class="mt-4 space-y-4">
              {
                discord.items.map((it) => (
                  <li class="border-border bg-surface rounded-lg border p-4">
                    <div class="text-sm font-semibold">{it.title}</div>
                    <div class="text-muted mt-2 text-sm leading-relaxed" set:html={it.html} />
                  </li>
                ))
              }
            </ol>
          </div>
        </div>
      </Card>
    </div>
  </section>
</V2Layout>
