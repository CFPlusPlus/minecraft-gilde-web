---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Card from '../../components/ui/Card.astro';
import Button from '../../components/ui/Button.astro';
import { ArrowRight, BookOpen, Hammer, Shield, Cpu, Users, ScrollText } from '@lucide/astro';

type FaqItem = { q: string; a: string };

const groups: Array<{ title: string; icon: any; items: FaqItem[] }> = [
  {
    title: 'Erststart & Grundlagen',
    icon: BookOpen,
    items: [
      {
        q: 'Ich bin neu auf dem Server – Gibt es ein Tutorial?',
        a: 'Damit du dich schnell zurechtfindest, haben wir ein Tutorial für den Erststart vorbereitet. Dort erfährst du alles Wichtige rund um Regeln, Gameplay und Features. Außerdem findest du am Spawn überall Infotafeln – und im Chat hilft dir die Community gerne weiter.\n\n→ Tutorial: /tutorial/',
      },
      {
        q: 'Ist die Nutzung des Servers kostenlos?',
        a: 'Ja! Die Nutzung ist vollständig kostenlos. Es gibt keinerlei kaufbare Ränge oder Items – alle Spieler haben die gleichen Chancen und Möglichkeiten.',
      },
      {
        q: 'Kann ich mit einem „gecrackten“ Minecraft spielen?',
        a: 'Nein. Es können ausschließlich Spieler mit legal erworbenem Premium-Account joinen. Wir möchten keine Software-Piraterie unterstützen.',
      },
    ],
  },
  {
    title: 'Grundstücke & Bauen',
    icon: Hammer,
    items: [
      {
        q: 'Wie erstelle ich ein Grundstück?',
        a: 'Mit einer Holzschaufel kannst du dir Grundstücke erstellen. Markiere die zwei gegenüberliegenden Ecken deines Grundstücks per Rechtsklick. Wenn du erstmalig eine Truhe platzierst, wird automatisch ein Grundstück erstellt, das du später erweitern kannst.\n\nVideo-Anleitung: https://www.youtube.com/watch?v=tK15LgTwvjI',
      },
      {
        q: 'Wie groß können meine Grundstücke werden und wie viele darf ich erstellen?',
        a: 'Du kannst beliebig viele Grundstücke erstellen – es gibt kein Limit bei der Anzahl. Entscheidend ist die Gesamtfläche: Alle deine Grundstücke zusammen dürfen maximal 120.000 Blöcke groß sein. Pro Spielstunde bekommst du 1.000 Claim-Blöcke dazu, bis du das Maximum erreicht hast. Du kannst die Blöcke frei auf mehrere Claims verteilen.',
      },
      {
        q: 'Gibt es Vorgaben, wie ich bauen muss?',
        a: 'Es gibt keine festen Vorgaben – du kannst frei bauen, wie du möchtest. Bestimmte „unschöne“ Bauwerke können aber entfernt werden (z. B. 1x1-Säulen, Erdklötze als Dauerlösung, offen liegende Tunnel, riesige unintegrierte Farmen oder verlassene Baustellen). Wenn du unsicher bist, frag gern das Team.',
      },
    ],
  },
  {
    title: 'Gameplay & Sicherheit',
    icon: Shield,
    items: [
      {
        q: 'Können mich andere Spieler angreifen?',
        a: 'Das kommt darauf an: Auf deinem eigenen Grundstück bist du vor Angriffen geschützt. Außerhalb deines Grundstücks oder in einer Farmwelt können Spieler sich gegenseitig angreifen.',
      },
      {
        q: 'Wo finde ich Informationen zu den Server-Einstellungen?',
        a: 'Detaillierte Infos findest du auf der Seite „Server-Einstellungen“.\n\n→ Serverinfos: /serverinfos/',
      },
    ],
  },
  {
    title: 'Technik, Updates & Community',
    icon: Cpu,
    items: [
      {
        q: 'Es gibt eine neue Minecraft-Version. Soll ich das Update direkt durchführen?',
        a: 'Bitte warte zunächst mit dem Update. Wir bringen den Server so schnell wie möglich auf die neueste Version, müssen aber erst abwarten, bis wichtige Plugins und die Server-Software stabil aktualisiert sind. Aktuelle Infos findest du immer auf Discord.',
      },
      {
        q: 'Seit wann gibt es die Minecraft Gilde?',
        a: 'Seit dem 1. Januar 2025. Wenn du mehr über unsere Entwicklung und Meilensteine erfahren möchtest, schau gern in die Geschichte.',
      },
      {
        q: 'Darf ich ein YouTube-Video/Twitch-Stream machen und die Server-Adresse zeigen?',
        a: 'Sehr gerne! Du darfst die IP-Adresse in deinen Videos oder Streams selbstverständlich zeigen. Wenn du Interesse hast, offizieller Streamer zu werden, melde dich gern bei einem Admin.',
      },
    ],
  },
];

const linkify = (text: string) => {
  // very small helper: replace "→ ...: /path/" lines with real links
  return text
    .replace(/\n\n/g, '\n')
    .replace(
      /(https?:\/\/[^\s]+)/g,
      '<a href="$1" target="_blank" rel="noopener noreferrer" class="text-accent underline decoration-transparent underline-offset-4 hover:decoration-accent/60">$1</a>',
    )
    .replace(/(→\s*[^:]+:\s*)(\/[a-z0-9\-\/]+\/?)/gi, (_m, p1, p2) => {
      return `${p1}<a href="${p2}" class="text-accent underline decoration-transparent underline-offset-4 hover:decoration-accent/60">${p2}</a>`;
    });
};
---

<BaseLayout
  title="Minecraft Gilde - FAQ"
  canonical="https://minecraft-gilde.de/faq/"
  description="FAQ zur Minecraft Gilde: Erststart, Grundstücke, Updates, PvP, Technik & Community – übersichtlich gruppiert."
>
  <section class="mg-container pt-12 pb-8">
    <h1 class="text-3xl font-semibold tracking-tight">FAQ</h1>
    <p class="text-muted mt-2 max-w-3xl">
      Häufige Fragen – kurz, klar und übersichtlich. Wenn etwas fehlt: schreib uns gerne auf
      Discord.
    </p>

    <div class="mt-6 flex flex-wrap gap-2">
      <Button href="/tutorial" variant="secondary" size="sm" class="gap-2">
        <BookOpen size={16} /> Tutorial
      </Button>
      <Button href="/regeln" variant="ghost" size="sm" class="gap-2">
        <Shield size={16} /> Regeln
      </Button>
      <Button href="/voten" variant="ghost" size="sm" class="gap-2">
        <ArrowRight size={16} /> Voten
      </Button>
    </div>
  </section>

  <section class="mg-container pb-16">
    <div class="grid gap-4">
      {
        groups.map((g) => (
          <Card class="p-6">
            <div class="flex items-start gap-4">
              <div class="border-border/70 bg-accent/10 text-accent mt-0.5 flex h-12 w-12 shrink-0 items-center justify-center rounded-xl border">
                <g.icon class="h-7 w-7" />
              </div>

              <div class="min-w-0 flex-1">
                <h2 class="text-lg font-semibold tracking-tight">{g.title}</h2>

                <div class="mt-4 grid gap-2">
                  {g.items.map((it) => (
                    <details class="border-border bg-surface/55 rounded-[var(--radius)] border px-4 py-3">
                      <summary class="cursor-pointer list-none text-sm font-semibold outline-none">
                        <span class="inline-flex items-center gap-2">
                          <span
                            class="bg-accent mt-0.5 h-2 w-2 flex-none rounded-full"
                            aria-hidden="true"
                          />
                          {it.q}
                        </span>
                      </summary>
                      <div
                        class="text-muted mt-3 text-sm leading-relaxed"
                        set:html={linkify(it.a)}
                      />
                    </details>
                  ))}
                </div>
              </div>
            </div>
          </Card>
        ))
      }
    </div>

    <div class="mt-8">
      <Card class="p-6">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
          <div class="min-w-0">
            <h2 class="text-lg font-semibold tracking-tight">Noch Fragen?</h2>
            <p class="text-muted mt-2 text-sm">
              Auf Discord findest du Updates, Hilfe und die Community.
            </p>
          </div>
          <div class="flex gap-2">
            <Button href="/serverinfos" variant="secondary" size="sm" class="gap-2">
              <ScrollText size={16} /> Serverinfos
            </Button>
            <Button
              href="https://discord.minecraft-gilde.de"
              external
              variant="primary"
              size="sm"
              class="gap-2"
            >
              <Users size={16} /> Discord <ArrowRight size={16} />
            </Button>
          </div>
        </div>
      </Card>
    </div>
  </section>
</BaseLayout>
