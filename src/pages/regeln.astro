---
import BaseLayout from '../layouts/BaseLayout.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';
import { getEntry } from 'astro:content';
import { AlertTriangle, Book, MessageSquareText, Copy, ArrowRight } from '@lucide/astro';

const rules = await getEntry('rules', 'main');
if (!rules) throw new Error('Rules entry "main" not found');

const { warning, minecraft, discord, serverIp } = rules.data;
const ip = serverIp || 'minecraft-gilde.de';
---

<BaseLayout
  title="Minecraft Gilde - Unser Regelwerk"
  canonical="https://minecraft-gilde.de/regeln/"
  description="Alle Regeln für den Minecraft Vanilla Server der Gilde – fair, klar und verständlich. Griefing, Hacks, Spam & Werbung verboten. Jetzt Regelwerk lesen!"
>
  <section class="mg-container pt-12 pb-6">
    <h1 class="text-3xl font-semibold tracking-tight">Regeln</h1>
    <p class="text-muted mt-2">Fair play. Wenig Bürokratie. Klare Grenzen.</p>

    <div class="mg-callout mt-6" data-variant="warning">
      <div class="flex gap-3">
        <AlertTriangle size={20} class="mt-0.5" />
        <div>
          <p class="text-sm font-semibold">Wichtiger Hinweis</p>
          <p class="text-fg/90 mt-1 text-sm">{warning}</p>
        </div>
      </div>
    </div>

    <div class="mt-6 flex flex-wrap gap-3">
      <Button variant="primary" class="gap-2" data-copy-ip>
        <Copy size={18} /> IP kopieren
      </Button>
      <Button href="/tutorial" variant="secondary" class="gap-2">
        <ArrowRight size={18} /> Tutorial
      </Button>
      <Button href="/statistiken" variant="ghost" class="gap-2">
        <ArrowRight size={18} /> Statistiken
      </Button>
    </div>

    <p class="text-muted mt-3 text-xs">IP: <span class="text-fg/90 font-medium">{ip}</span></p>
  </section>

  <section class="mg-container pb-16">
    <div class="grid gap-4 lg:grid-cols-2">
      <Card class="p-6">
        <div class="flex items-start gap-4">
          <div
            class="border-border/70 bg-accent/10 text-accent mt-0.5 flex h-12 w-12 shrink-0 items-center justify-center rounded-xl border"
          >
            <Book class="h-7 w-7" />
          </div>
          <div>
            <h2 class="text-xl font-semibold tracking-tight">{minecraft.title}</h2>
            <ol class="mt-4 space-y-4">
              {
                minecraft.items.map((it) => (
                  <li class="border-border bg-surface rounded-lg border p-4">
                    <div class="text-sm font-semibold">{it.title}</div>
                    <div class="text-muted mt-2 text-sm leading-relaxed" set:html={it.html} />
                  </li>
                ))
              }
            </ol>
          </div>
        </div>
      </Card>

      <Card class="p-6">
        <div class="flex items-start gap-4">
          <div
            class="border-border/70 bg-accent/10 text-accent mt-0.5 flex h-12 w-12 shrink-0 items-center justify-center rounded-xl border"
          >
            <MessageSquareText class="h-7 w-7" />
          </div>
          <div>
            <h2 class="text-xl font-semibold tracking-tight">{discord.title}</h2>
            <ol class="mt-4 space-y-4">
              {
                discord.items.map((it) => (
                  <li class="border-border bg-surface rounded-lg border p-4">
                    <div class="text-sm font-semibold">{it.title}</div>
                    <div class="text-muted mt-2 text-sm leading-relaxed" set:html={it.html} />
                  </li>
                ))
              }
            </ol>
          </div>
        </div>
      </Card>
    </div>
  </section>
</BaseLayout>
